import{r as l,W as P,j as e,a as n,b as $}from"./app-DecQ0f_S.js";import{H as B,N as R}from"./Nav-BWBa_EZw.js";import{R as k}from"./index-e435n7mr.js";import{C as H}from"./index-Y3mSmgPm.js";import{N as I}from"./notyf.min-DLu_xjpT.js";import{a as O}from"./index-BPKSu1J7.js";import"./iconBase-DWhxbjqT.js";import"./index-c1-G4gL8.js";const i=new I;function T({user:b,user_type:g,notif:w,leads:o,assignEmp:x,projects:q}){let y=[];const[a,L]=l.useState(""),[d,C]=l.useState(o.length>0?o:y),[m,h]=l.useState(1),[c]=l.useState(10),{delete:v}=P();console.log("assignEmp",x),l.useEffect(()=>{const s=d.filter(t=>{var r,j,f,N;return((r=t.name)==null?void 0:r.toLowerCase().includes(a.toLowerCase()))||((j=t.subject)==null?void 0:j.toLowerCase().includes(a.toLowerCase()))||((f=t.lead_stage)==null?void 0:f.toLowerCase().includes(a.toLowerCase()))||((N=t.lead_source)==null?void 0:N.toLowerCase().includes(a.toLowerCase()))});C(s)},[a,o]);const u=m*c,E=u-c,p=d.slice(E,u),S=Math.ceil(d.length/c),F=Array.from({length:S},(s,t)=>t+1),A=s=>{L(s.target.value),h(1)},_=(s,t)=>{s.preventDefault(),confirm("Are you sure you want to delete?")?v(`/lead/${t}`,{onSuccess:()=>{console.log("Form submitted successfully"),i.success("Leads Deleted successfully"),window.location.reload()},onError:r=>{console.log("Form submission error",r)}}):console.log("Error fetching data")},D=(s,t)=>{console.log(`Lead ID: ${s}, Assigned Employee ID: ${t}`),$.post("/lead/assign",{leadId:s,empId:t}).then(r=>{i.success("Employee assigned successfully")}).catch(r=>{i.error("Failed to assign employee"),console.error(r)})};return e.jsxs("div",{className:"w-[85.2%] absolute right-0 overflow-hidden",children:[e.jsx(B,{user:b,notif:w}),e.jsx(R,{user_type:g}),e.jsxs("div",{className:"table-section border-[#0A1B3F] py-3 px-8 rounded-b-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"w-[40%]",children:e.jsx("input",{type:"text",value:a,onChange:A,placeholder:"Search leads...",className:"p-2 border rounded-md w-[80%]"})}),e.jsx("div",{className:"px-4",children:e.jsx(n,{href:"/lead/create",className:"flex space-x-2 underline",children:e.jsx("span",{className:"font-bold",children:"Create New Lead"})})})]}),e.jsx("br",{}),e.jsxs("table",{className:"table w-full p-4 border",children:[e.jsx("thead",{className:"border bg-[#0A1B3F] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left border",children:"Client Name"}),e.jsx("th",{className:"p-3 text-left border",children:"Email"}),e.jsx("th",{className:"p-3 text-left border",children:"Phone No"}),e.jsx("th",{className:"p-3 text-left border",children:"Lead Source"}),e.jsx("th",{className:"p-3 text-left border",children:"Status"}),e.jsx("th",{className:"p-3 text-left border",children:"Lead Stage"}),e.jsx("th",{className:"p-3 text-left border",children:"Assign"}),e.jsx("th",{className:"p-3 text-left border",children:"Action"})]})}),e.jsx("tbody",{children:p.length>0?p.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-3 border",children:s.client_name}),e.jsx("td",{className:"p-3 border",children:s.email_address}),e.jsx("td",{className:"p-3 border",children:s.phone_number}),e.jsx("td",{className:"p-3 border",children:s.source}),e.jsx("td",{className:"p-3 border",children:s.status}),e.jsx("td",{className:"p-3 border",children:s.lead_stage}),e.jsx("td",{className:"p-3 border",children:e.jsxs("select",{className:"border rounded p-2",defaultValue:s.assignedEmpId||"",onChange:t=>D(s.id,t.target.value),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Employee"}),x.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})}),e.jsx("td",{className:"border",children:e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsx(n,{className:"text-green-800 text-[1.1rem] bg-[#0C7785] p-1 rounded-md",href:`/lead/${s.id}/edit`,children:e.jsx(H,{className:"text-white"})}),e.jsx(n,{className:"text-green-800 text-[1.1rem] bg-[#0C7785] p-1 rounded-md",href:`/lead/${s.id}/view`,children:e.jsx(O,{className:"text-white"})}),e.jsx("button",{className:"text-white text-[1.1rem] bg-[#FF3A6E] p-1 rounded-md",onClick:t=>_(t,s.id),children:e.jsx(k,{})})]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-3 text-center",children:"No leads found"})})})]}),e.jsx("div",{className:"flex justify-center mt-4",children:F.map(s=>e.jsx("button",{onClick:()=>h(s),className:`px-4 py-2 mx-1 rounded ${m===s?"bg-blue-500 text-white":"bg-gray-200"}`,children:s},s))})]})]})}export{T as default};
