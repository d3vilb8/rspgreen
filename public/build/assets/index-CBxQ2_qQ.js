import{r as a,j as e,a as o,b as x}from"./app-OWEBvdtC.js";import{H as _,N as O,a as B}from"./Nav-CmIRCLvo.js";import{f as H}from"./index-CGRCqaVb.js";import{F as I}from"./index-BSTxKt_a.js";import{R as q}from"./index-R_jZdsaO.js";import"./iconBase-hI8KM4xB.js";const z=n=>{const d={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(n).toLocaleDateString(void 0,d)},W=({leave:n,user:d,user_type:r,notif:b})=>{const[v,y]=a.useState([]),[l,g]=a.useState(""),[h,w]=a.useState([]),[m,u]=a.useState(1),[c]=a.useState(10),[L,D]=a.useState(!1),[p,C]=a.useState(null);a.useEffect(()=>{Array.isArray(r)?y(r):console.error("Expected user_type to be an array:",r)},[r]),a.useEffect(()=>{const t=n.filter(s=>s.name.toLowerCase().includes(l.toLowerCase())||s.type_name.toLowerCase().includes(l.toLowerCase())||s.reason.toLowerCase().includes(l.toLowerCase()));w(t)},[l,n]);const j=m*c,S=j-c,f=h.slice(S,j),E=Math.ceil(h.length/c),A=Array.from({length:E},(t,s)=>s+1),k=t=>{g(t.target.value),u(1)},T=async t=>{try{await x.post(`/leave-approve/${t}`),alert("Leave approved successfully"),window.location.reload()}catch(s){console.error("There was an error approving the leave!",s)}},F=async t=>{try{await x.post(`/leave-reject/${t}`),alert("Leave rejected successfully"),window.location.reload()}catch(s){console.error("There was an error rejecting the leave!",s)}},R=async(t,s)=>{if(t.preventDefault(),window.confirm("Are you sure you want to delete this leave?"))try{await x.get(`/leave-store-delete/${s}`),alert("Leave deleted successfully"),window.location.reload()}catch(i){console.error("There was an error deleting the leave!",i)}},$=(t,s)=>{const i=new Date(t),P=new Date(s),M=Math.abs(P-i);return Math.ceil(M/(1e3*60*60*24))+1},N=t=>{C(p===t?null:t)};return e.jsxs("div",{className:"w-[85.2%] px-8 absolute right-0 overflow-hidden",children:[e.jsx(_,{user:d,notif:b}),e.jsx(O,{user_type:r}),e.jsx("div",{className:`modal absolute top-0 left-0 w-full h-full transition-all duration-500 bg-black/50 flex justify-center items-center ${L?"opacity-100 visible pointer-events-auto":"opacity-0 invisible pointer-events-none"}`,children:e.jsxs("div",{className:"w-2/5 p-4 px-6 bg-white rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Modal header"}),e.jsx("button",{onClick:()=>D(!1),children:e.jsx(I,{})})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("form",{action:"#",className:"py-3 space-y-5",children:[e.jsxs("div",{className:"flex flex-col gap-2 form-group",children:[e.jsx("label",{htmlFor:"start-date",className:"text-sm font-medium",children:"Start Date"}),e.jsx("input",{id:"start-date",type:"date",className:"rounded form-input"})]}),e.jsxs("div",{className:"flex flex-col gap-2 form-group",children:[e.jsx("label",{htmlFor:"end-date",className:"text-sm font-medium",children:"End Date"}),e.jsx("input",{id:"end-date",type:"date",className:"rounded form-input"})]}),e.jsxs("div",{className:"flex flex-col gap-2 form-group",children:[e.jsx("label",{htmlFor:"number",className:"text-sm font-medium",children:"Number"}),e.jsx("input",{id:"number",type:"number",className:"rounded form-input"})]}),e.jsx("div",{children:e.jsx("button",{className:"px-8 py-2 text-sm font-semibold text-white bg-blue-500 rounded-md",children:"Submit"})})]})]})}),e.jsxs("div",{className:"px-8 table-section",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("input",{type:"text",value:l,onChange:k,placeholder:"Search employees...",className:"w-1/3 p-2 border rounded-md"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"grid p-2 mt-2 text-black rounded-lg place-items-center",children:e.jsx(o,{href:"leave-create",className:"underline",children:"Add New"})}),v.includes("view_leave_type")&&e.jsx("div",{className:"grid p-2 mt-2 text-black rounded-lg place-items-center",children:e.jsx(o,{href:"leave-type",children:"Leave Type"})})]})]}),e.jsx("br",{}),e.jsxs("table",{className:"table w-full p-4 border",children:[e.jsx("thead",{className:"border bg-[#0A1B3F] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left border",children:"Employee Name"}),e.jsx("th",{className:"p-3 text-left border",children:"Leave Type"}),e.jsx("th",{className:"p-3 text-left border",children:"Applied On"}),e.jsx("th",{className:"p-3 text-left border",children:"Start Date"}),e.jsx("th",{className:"p-3 text-left border",children:"End Date"}),e.jsx("th",{className:"p-3 text-left border",children:"Total Days"}),e.jsx("th",{className:"p-3 text-left border",children:"Leave Reason"}),e.jsx("th",{className:"p-3 text-left border",children:"Extra Leave"}),e.jsx("th",{className:"p-3 text-left border",children:"Status"}),e.jsx("th",{className:"p-3 text-left border",children:"Action"})]})}),e.jsx("tbody",{children:f.length>0?f.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-3 border",children:t.name}),e.jsx("td",{className:"p-3 border",children:t.type_name}),e.jsx("td",{className:"p-3 border",children:z(t.created_at)}),e.jsx("td",{className:"p-3 border",children:t.sdate}),e.jsx("td",{className:"p-3 border",children:t.edate}),e.jsx("td",{className:"p-3 border",children:$(t.sdate,t.edate)}),e.jsx("td",{className:"p-3 border",children:t.reason}),e.jsx("td",{className:"p-3 border",children:t.is_unpaid===1?e.jsx("p",{className:"text-[1rem] text-center",children:"Unpaid"}):e.jsx("p",{className:"text-[1rem] text-center",children:"Paid"})}),e.jsx("td",{className:"p-3 border relative",onClick:()=>N(t.id),children:d==="Admin"?e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:t.status===0?"px-2 py-1 m-1 text-blue-700  rounded transition-colors duration-300 ease-in-out ":t.status===1?"px-2 py-1 m-1 text-red-700  rounded transition-colors duration-300 ease-in-out ":t.status===2?"px-2 py-1 m-1 text-gray-700  rounded transition-colors duration-300 ease-in-out ":"",onClick:()=>N(t.id),children:t.status===0?"Approve":t.status===1?"Reject":t.status===2?"pending":""}),e.jsx("div",{className:`absolute left-0 top-0  h-[6rem] z-40 mt-9 bg-white rounded shadow-lg transition-all duration-300 ease-in-out overflow-hidden ${p===t.id?"max-h-screen opacity-100":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"",children:[e.jsx("p",{onClick:()=>T(t.id),className:"text-gray-800 p-2 hover:text-green-500 cursor-pointer ",children:"Approve"}),e.jsx("hr",{}),e.jsx("p",{onClick:()=>F(t.id),className:"text-gray-800 p-2 hover:text-red-500 cursor-pointer",children:"Reject"})]})})]}):t.status===0?e.jsx("span",{className:"text-blue-500",children:"Approve"}):t.status===1?e.jsx("span",{className:"text-red-700",children:"Reject"}):t.status===2?e.jsx("span",{className:"text-gray-900",children:"pending"}):""}),e.jsx("td",{className:"border",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(o,{className:"text-white p-2 rounded text-[1.5rem] bg-blue-500",href:`leave/show/${t.id}`,children:e.jsx(B,{})}),e.jsx(o,{className:"bg-green-800 p-2 rounded text-white text-[1.5rem]",href:`leave-store-edit/${t.id}`,children:e.jsx(H,{})}),e.jsx("button",{className:"bg-red-800 p-2 rounded text-white text-[1.5rem]",onClick:s=>R(s,t.id),children:e.jsx(q,{})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"py-4 text-center",children:"No results found"})})})]}),e.jsx("div",{className:"flex justify-between mt-4",children:e.jsx("div",{className:"flex items-center space-x-2",children:A.map(t=>e.jsx("button",{onClick:()=>u(t),className:`px-4 py-2 rounded ${m===t?"bg-blue-500 text-white":"bg-gray-200"}`,children:t},t))})})]})]})};export{W as default};
