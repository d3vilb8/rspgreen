import{W as f,r as x,j as e,a as N}from"./app-DecQ0f_S.js";import{H as C,N as y,I as w}from"./Nav-BWBa_EZw.js";import{N as F}from"./notyf.min-DLu_xjpT.js";import"./iconBase-DWhxbjqT.js";import"./index-BPKSu1J7.js";import"./index-c1-G4gL8.js";const c=new F,D=({employees:S,user_type:j,user:p,notif:v,clients:u,leadSources:E,leadStage:h,projects:A,taskNames:i})=>{const{data:l,setData:d,post:g,errors:a}=f({client_id:"",email_address:"",phone_number:"",source:"",lead_for:"",lead_stage:"",comment:"",status:"",rate:"",commission:"",total_amount:""});x.useState(null);const _=(s,n)=>s&&n?(s*(n/100)).toFixed(2):0;console.log("amin",i);const r=s=>{const{name:n,value:o}=s.target;if(n==="source"){const t=i.find(m=>m.task_name===o);d({...l,source:o,rate:t?t.rate:""})}else d({...l,[n]:o})};x.useEffect(()=>{if(l.rate&&l.commission){const s=parseFloat(_(l.rate,l.commission)).toFixed(2);d("commission",commission),d("total_amount",s)}},[l.rate,l.commission]);const b=s=>{s.preventDefault(),g("/lead",{onSuccess:()=>{c.success("Leads Created successfully")},onError:n=>{typeof n=="object"&&n!==null?Object.entries(n).forEach(([o,t])=>{Array.isArray(t)?t.forEach(m=>c.error(m)):c.error(t)}):c.error("An unexpected error occurred.")}})};return e.jsxs("div",{className:"w-[85.2%] ml-[11.5rem]",children:[e.jsx(C,{user:p,notif:v}),e.jsx(y,{user_type:j}),e.jsxs("div",{className:"px-[10rem] grid border-blue-950 rounded-b-md space-y-3",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(N,{href:"/lead",className:"flex p-1 px-4 space-x-2 text-white rounded-md bg-slate-600",children:[e.jsx("span",{className:"grid place-items-center",children:e.jsx(w,{})}),e.jsx("span",{children:"back"})]})}),e.jsxs("form",{onSubmit:b,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"client_id",children:"Client's Name"}),e.jsxs("select",{className:"w-full rounded-lg",name:"client_id",value:l.client_id,onChange:r,children:[e.jsx("option",{value:"",children:"-- Select Client --"}),u&&u.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),a.client_id&&e.jsx("div",{children:a.client_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email_address",children:"Email Address"}),e.jsx("input",{id:"email_address",className:"w-full rounded-lg",name:"email_address",type:"email",value:l.email_address,onChange:r,required:!0}),a.email_address&&e.jsx("div",{children:a.email_address})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone_number",children:"Phone Number"}),e.jsx("input",{id:"phone_number",className:"w-full rounded-lg",name:"phone_number",type:"tel",value:l.phone_number,onChange:r,required:!0}),a.phone_number&&e.jsx("div",{children:a.phone_number})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source",children:"Project"}),e.jsxs("select",{className:"w-full rounded-lg",name:"source",value:l.source,onChange:r,children:[e.jsx("option",{value:"",children:"-- Select Project --"}),i&&i.length>0?i.map(s=>e.jsx("option",{value:s.task_name,children:s.task_name},s.id)):e.jsx("option",{disabled:!0,children:"No tasks available"})]}),a.source&&e.jsx("div",{children:a.source})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"rate",children:"Rate"}),e.jsx("input",{id:"rate",className:"w-full rounded-lg",name:"rate",type:"number",value:l.rate,onChange:r,readOnly:!0}),a.rate&&e.jsx("div",{children:a.rate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"commission",children:"Commission (%)"}),e.jsx("input",{id:"commission",className:"w-full rounded-lg",name:"commission",type:"number",value:l.commission,onChange:r,placeholder:"Enter Commission Percentage"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"total_amount",children:"Total Amount"}),e.jsx("input",{id:"total_amount",className:"w-full rounded-lg",name:"total_amount",type:"text",value:l.total_amount,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lead_stage",children:"Lead Stage"}),e.jsxs("select",{id:"lead_stage",className:"w-full rounded-lg",name:"lead_stage",value:l.lead_stage,onChange:r,required:!0,children:[e.jsx("option",{value:"",children:"-- Select Lead Stage --"}),h.length>0?h.map((s,n)=>e.jsx("option",{value:s.name,children:s.name},n)):e.jsx("option",{disabled:!0,children:"No lead stages available"})]}),a.lead_stage&&e.jsx("div",{children:a.lead_stage})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",className:"w-full rounded-lg",name:"status",value:l.status,onChange:r,required:!0,children:[e.jsx("option",{value:"",children:"-- Select Status --"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"in_progress",children:"In Progress"})]}),a.status&&e.jsx("div",{children:a.status})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",children:"Comment"}),e.jsx("textarea",{id:"comment",className:"w-full rounded-lg",name:"comment",value:l.comment,onChange:r,required:!0}),a.comment&&e.jsx("div",{children:a.comment})]}),e.jsx("button",{type:"submit",className:"bg-[#0A1B3F] p-2 rounded-md text-white w-[20%]",children:"Create"})]})]})]})};export{D as default};
