import{r as l,W as v,j as e}from"./app-OWEBvdtC.js";import D from"./sidebar-mDdbHRnq.js";import{H as B,N as C}from"./Nav-CmIRCLvo.js";import{M as E}from"./Modal-Di6ygOb6.js";import{N as M}from"./notyf.min-DLu_xjpT.js";import"./iconBase-hI8KM4xB.js";import"./index-CGRCqaVb.js";import"./index-BSTxKt_a.js";import"./transition-CLzje324.js";const R=({user:u,notif:x,user_type:p,departments:b})=>{const[j,c]=l.useState(!1),[r,o]=l.useState(null),s=new M,{data:f,setData:d,post:i,put:S,reset:N,errors:m}=v({d_name:""});l.useEffect(()=>{n()},[]);const n=async()=>{try{const t=await axios.get("/departments");setBranches(t.data)}catch(t){console.error("Error fetching branches:",t)}},h=(t=null)=>{c(!0),d("d_name",t?t.d_name:""),o(t?t.id:null)},a=()=>{c(!1),o(null),N("d_name")},y=t=>{t.preventDefault(),r?i(`/departments/${r}`,{onSuccess:()=>{s.success("Branch updated successfully!"),n(),a()},onError:()=>{s.error("An error occurred while updating the branch.")}}):i("/departments",{onSuccess:()=>{s.success("Branch created successfully!"),n(),a()},onError:()=>{s.error("An error occurred while creating the branch.")}})},g=async t=>{if(confirm("Are you sure you want to delete this branch?"))try{await axios.delete(`/departments/${t}`),s.success("Branch deleted successfully!"),window.location.reload()}catch(w){console.error("Error deleting branch:",w),s.error("Department deleted successfully!"),window.location.reload()}};return e.jsxs("div",{className:"w-[85.2%] absolute right-0",children:[e.jsx(B,{user:u,notif:x}),e.jsx(C,{user_type:p}),e.jsxs("div",{className:"flex px-9",children:[e.jsx(D,{}),e.jsxs("div",{className:"flex-1 p-6 bg-gray-100",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"mb-4 text-2xl font-bold",children:"Manage Departments"}),e.jsx("button",{onClick:()=>h(),className:"p-2 text-teal-900 underline rounded-md",children:"Create Departments"})]}),e.jsx("div",{className:"mt-3",children:e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Departments Name"}),e.jsx("th",{className:"px-4 py-2 text-right border-b",children:"Action"})]})}),e.jsx("tbody",{className:"",children:b.map(t=>e.jsxs("tr",{className:"transition duration-200 hover:bg-gray-100",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:t.name}),e.jsxs("td",{className:"px-4 py-2 text-right border-b",children:[e.jsx("button",{onClick:()=>h(t),className:"text-blue-600 underline hover:text-blue-800",children:"Edit"}),e.jsx("button",{onClick:()=>g(t.id),className:"ml-4 text-red-600 underline hover:text-red-800",children:"Delete"})]})]},t.id))})]})})]})]}),e.jsx(E,{show:j,onClose:a,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold",children:r?"Edit Departments":"Create New Departments"}),m.name&&e.jsx("p",{className:"text-red-600",children:m.name}),e.jsxs("form",{onSubmit:y,className:"mt-4",children:[e.jsxs("label",{className:"block mb-2",children:["Departments Name:",e.jsx("input",{type:"text",value:f.d_name,onChange:t=>d("d_name",t.target.value),className:"block w-full p-2 mt-1 border border-gray-300 rounded-md",required:!0})]}),e.jsx("button",{type:"submit",className:"p-2 mt-4 text-white bg-blue-600 rounded-md",children:r?"Update Branch":"Create Branch"}),e.jsx("button",{onClick:a,type:"button",className:"p-2 mt-2 text-white bg-red-600 rounded-md",children:"Close"})]})]})})]})};export{R as default};
